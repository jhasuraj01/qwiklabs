---
id: GSP313
title: GSP313 Challenge Lab
sidebar_position: 7
tags: [Qwiklabs]
description: >
  This challenge lab tests your skills and knowledge from the labs in the
  Create and Manage Cloud Resources quest. You should be familiar with the
  content of the labs before attempting this lab.
keywords: [Google Cloud Ready, GCP, Qwiklabs, GoogleCloudReady, 30DaysOfGoogleCloud, Cloud, Qwiklab, Qwiklabs Google Cloud, web, google cloud, Google Cloud Platform, Google Events, Free Google Swag, GSP313, Google Cloud ready facilitator program, Google Cloud Ready Program, 30 days of google cloud, Google Cloud Ready Program Prizes, Challenge Lab Qwiklabs, Learn to Earn Cloud Challenge]
---

# GSP313 Create and Manage Cloud Resources: Challenge Lab

> Challenge Lab: https://google.qwiklabs.com/focuses/10258?parent=catalog

## Setup
Set Default Compute Zone and Region
```bash
gcloud config set compute/zone us-east1-b
gcloud config set compute/region us-east1
```

## Task 1: Create a project jumphost instance

Create an instance with command line
```bash
gcloud compute instances create nucleus-jumphost \
  --machine-type f1-micro
```

## Task 2: Create a Kubernetes service cluster

### Create a GKE cluster
```bash
gcloud container clusters create my-cluster
```

### Get authentication credentials for the cluster
```bash
gcloud container clusters get-credentials my-cluster
```

### Deploy an application to the cluster
```bash
kubectl create deployment hello-server --image gcr.io/google-samples/hello-app:2.0
```

### Expose your application to external traffic
```bash
kubectl expose deployment hello-server --type LoadBalancer --port 8080
```

### Check if service is up and running
```bash
kubectl get service
```

## Task 3: Set up an HTTP load balancer

### Create Startup Script
```bash
cat << EOF > startup.sh
#! /bin/bash
apt-get update
apt-get install -y nginx
service nginx start
sed -i -- 's/nginx/Google Cloud Platform - '"\$HOSTNAME"'/' /var/www/html/index.nginx-debian.html
EOF
```

### Create Instance Template
```bash
gcloud compute instance-templates create nginx-web-server-template \
  --network default \
  --tags nginx-web-server \
  --machine-type f1-micro \
  --metadata-from-file startup-script=startup.sh
```
<!-- 
### Create a target pool

```bash
gcloud compute http-health-checks create basic-check
gcloud compute target-pools create nginx-web-server-pool \
  --http-health-check basic-check
``` -->

### Create Managed Instance Group
```bash
gcloud compute instance-groups managed create nginx-web-servers \
  --size 2 \
  --template nginx-web-server-template
```

### Firewall rule
```bash
gcloud compute firewall-rules create nginx-web-server-firewall \
  --network default \
  --allow tcp:80 \
  --target-tags nginx-web-server
```

### Create a health check
```bash
gcloud compute health-checks create http http-basic-check \
  --port 80
```

### Create a backend service
```bash
gcloud compute backend-services create web-backend-service \
  --protocol HTTP \
  --port-name http \
  --health-checks http-basic-check \
  --global
```

### Attach the managed instance group to a backend service
```bash
gcloud compute backend-services add-backend web-backend-service \
  --instance-group nginx-web-servers \
  --global
```

### Create a URL map
```bash
gcloud compute url-maps create nginx-server-map \
  --default-service web-backend-service
```

### Target the HTTP proxy to route requests to your URL map
```bash
gcloud compute target-http-proxies create http-lb-proxy \
  --url-map nginx-server-map
```

### Forwarding Rule
```bash
gcloud compute forwarding-rules create nginx-web-server-forwarding-rule \
  --global \
  --ports 80 \
  --target-http-proxy http-lb-proxy
```

### Get a list of Forwarding Rules
```bash
gcloud compute forwarding-rules list
```